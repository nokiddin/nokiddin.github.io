<!DOCTYPE html>
<!-- adapted from url=http://mdaines.github.io/viz.js/form.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <title>dot -&gt; svg</title>
    <style>
      
    #input {
      width: 500px;
      height: 300px;
    }

	#divinput {
		display: none;
	}
      
    </style>
  <style type="text/css"></style></head>
  <body>
	<div id="divinput"> 
    <p><textarea id="input">digraph G {

}
	</textarea></p>
    <a href="sample-simple.html">Simple sample</a>    
    <a href="sample-process.html">Process Sample</a>
    <p><button id="generate">Generate</button></p>
	</div>

    <!--  
    <p>
      <label>Output format:</label>
      <select id="format">
        <option>dot</option>
        <option>plain</option>
        <option selected="">svg</option>
        <option>xdot</option>
      </select>
    </p>
    
    <p>
      <label>Layout engine:</label>
      <select id="engine">
        <option selected="">dot</option>
        <option>neato</option>
      </select>
    </p>
    -->
    
    <div id="output"></div>
    <div id="inspect"></div>
    
    <script src="http://nokiddin.github.io/viz.js"></script>
    <!-- <script src="viz.js"></script> -->
    <script>
	function wrapasdigraph(x){
		return  "digraph G {\n" + x + "\n}";
	}
	function readfragment(s){
		if(!s) return {};
		if(s.substr(0,3)=='#d:'){
			return {data:wrapasdigraph(s.substring(3)), flag:"grf"};
		}else if(s.substr(0,4)=="#ds:"){
			return {data:wrapasdigraph(s.substring(4)), flag:"grf,src"};
		}
	}
	function generate_svg(sdot){
		var svg=Viz(sdot, "svg", "dot");
		return result = { svg: svg } ;
	}
	function onload_(){
		var input=readfragment(window.location.hash);
		if(input && input.data){
			
			var bshowsrc, bshowgrf;
			bshowgrf = (input.flag && (","+input.flag+",").match(/,grf,/));
			bshowsrc = (input.flag && (","+input.flag+",").match(/,src,/));

			displayresults(generate_svg(input.data).svg, bshowgrf, bshowsrc);
		}else{
			el("divinput").style.display="inherit";
		}
	}
	window.onload=onload_;
	
    function inspect(s) {
      return "<pre>" + s.replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/\"/g, "&quot;") + "</pre>";
    }

	function el(id){
		return document.getElementById(id);
	}
	function render(id, text, visible){
		el(id).innerHTML = text; //is set even for display:none case, for any programmatic dom access. 
		el(id).style.display=visible?"inherit":"none";
	}
	function displayresults(svg, showgrf, showsrc){
		render("output", svg, showgrf);
		render("inspect", inspect(svg), showsrc);
	}
      
    el("generate").addEventListener("click", function(e) {
      var result = generate_svg(el("input").value);
      
      if (result && result.svg) {
		displayresults(result.svg, true);
      } else {
        displayresults("", true);
      }
      
    });
      
    </script>
    
  
</body></html>
